<!DOCTYPE html>

<title>FARI - Animal welfare</title>
<link rel = "icon" href ="staticFiles/img/marker.png" type = "image/x-icon">
<html lang="en">

<head>
    <script type="text/json" src="staticFiles/data/leaderboard.json"></script>
    <link rel="stylesheet" href="staticFiles/style/style.css">
    <style>
        body {
        font-family: "Sofia", sans-serif;
        }
    </style>
</head>

<body>

    <img class="logo" src="staticFiles/img/logo.png" alt="FARI Institute">

    <div class="score">
        <br>
        <h3 class="titlescore">Name | Score</h3>
        <ul id="leaderboard">
        </ul>
        <div class="center">
            <a class="but_play" href="{{url_for('play')}}">Play again</a>
        </div>
    </div>
    

</body>
</html>

<script>
    var play = {{players | tojson}}; //Move the Python dict into JS object

    // Put the new names and score in the leaderboard
    function updateLeaderboard(){
        var text = document.getElementById("leaderboard");
        for (const [key, value] of Object.entries(play)) {
            text.innerHTML += "<li><b class='textscore2'>" + key + "</b><p class='textscore'>" + value + "</p></li>";
        }
    }

    // Sort the dictionnary of username:score by decreasing score
    function sortDict(dict) {
        const sortable = Object.fromEntries(
            Object.entries(dict).sort(([,a],[,b]) => b-a)
        );
        return sortable;
    }

    // Convert a Python dict into a JavaScript dict strucutre
    function convertPyDictInJSDict(pydict){
        var dict = {}
        for (let i = 0; i < pydict.length; i++) {
            dict[pydict[i]["pseudo"]] = play[i]["score"];       
        }
        return dict;
    }

    play = convertPyDictInJSDict(play);
    play = sortDict(play);    
    updateLeaderboard();

</script>